<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Tebbee</title>
    <link rel="stylesheet" href="css/bootstrap.css" type="text/css"/>
    <link rel="stylesheet" href="css/tebbee.css" type="text/css"/>
    <link rel="stylesheet" href="css/mockup4.css" type="text/css"/>
    <link rel="stylesheet" href="css/style5.css" type="text/css"/>
    <link rel="stylesheet" href="css/stylegamma.css" type="text/css"/>
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:400,500,700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Terminal+Dosis' rel='stylesheet' type='text/css'/>
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500&subset=latin,vietnamese"/>
</head>
<body>
<div class="container col-lg-12 no-padding">
    <nav class="navbar navbar-default header" role="navigation">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="javascript:void(0);">Tebbee</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <form class="navbar-form navbar-left" role="search">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search">
                    </div>
                </form>
                <ul class="nav navbar-nav">
                    <li><a href="javascript:void(0);">Category</a></li>
                    <li><a href="javascript:void(0);">Moment</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="javascript:void(0);" class="register">Register</a></li>
                    <li><a href="javascript:void(0);" class="login">Login</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
<div class="tebbe-content">
<div class="wrapper">
    <div id="content-container" class="content-container">

        <div class="single-post">
            <div class="content">
                <div class="single-photo">
                    <img src="images/large/3.jpg"/>
                </div>
                <div class="info">
                    <h3 class="title">Lorem ipsum dolor sit amet, consectetur adipisicing elit</h3>
                    <small class="category">Post in <a href="javascript:void(0)">Category 1</a></small>
                    <div class="avatar">
                        <img src="images/large/demo-photo.png"/>
                    </div>
                    <div class="info-detail">
                        <div class="description">
                            <p><a href="javascript:void(0)">Shock Value</a> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                                tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                                quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                                consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                                cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                                proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                            <small>12 December at 09:27</small>
                        </div>
                    </div>
                </div>
                <a href="javascript:void(0)" class="view-comment" >Show comments</a>
                <div class="comment">
                    <div class="single-comment">
                        <div class="avatar">
                            <img src="images/large/demo-photo.png"/>
                        </div>
                        <div class="content">
                            <p><a href="javascript:void(0)">Shock Value</a> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                                tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                                quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                                consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                                cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                                proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                            <small>12 December at 09:27</small>
                        </div>
                        <div class="control"></div>
                    </div>
                    <div class="single-comment new-comment">
                        <div class="avatar">
                            <img src="images/large/demo-photo.png"/>
                        </div>
                        <form class="content">
                            <textarea rows="1" maxlength="500"></textarea>
                            <button type="submit">Comment</button>
                            <span class="chars"></span>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="single-post">
            <div class="content">
                <div class="single-photo">
                    <img src="images/large/demo-photo.png"/>
                </div>
                <div class="info">
                    <h3 class="title">Lorem ipsum dolor sit amet, consectetur adipisicing elit</h3>
                    <small class="category">Post in <a href="javascript:void(0)">Category 1</a></small>
                    <div class="avatar">
                        <img src="images/large/demo-photo.png"/>
                    </div>
                    <div class="info-detail">
                        <div class="description">
                            <p><a href="javascript:void(0)">Shock Value</a> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                                tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                                quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                                consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                                cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                                proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                            <small>12 December at 09:27</small>
                        </div>
                    </div>
                </div>
                <a href="javascript:void(0)" class="view-comment" >Show comments</a>
                <div class="comment">
                    <div class="single-comment">
                        <div class="avatar">
                            <img src="images/large/demo-photo.png"/>
                        </div>
                        <div class="content">
                            <p><a href="javascript:void(0)">Shock Value</a> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                                tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                                quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                                consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                                cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                                proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                            <small>12 December at 09:27</small>
                        </div>
                        <div class="control"></div>
                    </div>
                    <div class="single-comment new-comment">
                        <div class="avatar">
                            <img src="images/large/demo-photo.png"/>
                        </div>
                        <form class="content">
                            <textarea rows="1" maxlength="500"></textarea>
                            <button type="submit">Comment</button>
                            <span class="chars"></span>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="ads">
        <img src="images/large/the-red-bull-rabi-khan.jpg"/>
        <img src="images/large/the-red-bull-rabi-khan.jpg"/>
    </div>
</div>
</div>
    <div class="tebbe-footer">
        <div class="decorator">
            <div class="wrapper">
                <div class="decorator-right">
            <div class="decorator-content facebook"></div>
            <div class="decorator-content google"></div>
            <div class="decorator-content vimeo"></div>
            <div class="decorator-content rss"></div></div></div>
        </div>
        <div class="tebbee-info">
            <div class="info">
                <h3>Tebbee</h3>
                <p>27 Colmore Row Birmingham, England</br>email@tebbee.com</br>@ 2014 All Right Reserved</p>
            </div>
            <div class="link">
                <ul class="footer-link">
                    <li><a href="javascript:void(0);" >Policy</a></li>
                    <li><a href="javascript:void(0);" >Terms</a></li>
                    <li><a href="javascript:void(0);" >About us</a></li>
                    <li><a href="javascript:void(0);" >Contact</a></li>
                </ul>
                <ul class="footer-follow">
                    <li><a href="javascript:void(0);" class="web-symbol facebook" >f</a></li>
                    <li><a href="javascript:void(0);" class="web-symbol google" >g</a></li>
                    <li><a href="javascript:void(0);" class="web-symbol vimeo" >m</a></li>
                    <li><a href="javascript:void(0);" class="web-symbol rss" >r</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!--version jquery under 1.9 for masonry-->
<script src="js/jquery.min.js" type="text/javascript"></script>
<script src="js/modernizr.custom.js" type="text/javascript"></script>
<script src="js/bootstrap.min.js" type="text/javascript"></script>
<script src="js/classie.js" type="text/javascript"></script>
<script src="js/jquery.masonry.min.js"></script>
<script src="js/jquery.history.js"></script>
<script src="js/js-url.min.js"></script>
<script src="js/jquerypp.custom.js"></script>
<script src="js/gamma.js"></script>
<script src="js/jquery.autosize.min.js"></script>
<script src="js/main.js" type="text/javascript"></script>

<script>

    function resetPosts() {
        $(".view-comment").each(function () {
            var $_a = $(this);
            var $_comment = $(this).next(".comment");
            $_comment.hide();
            $_a.off();
            $_a.on("click", function () {
                $_comment.toggle("fast", function () {
                    if ($_comment.is(':visible')) {
                        $_a.html('Hide comments');
                    } else {
                        $_a.html('Show comments');
                    }
                });
            });
        });
        $('textarea').each(function () {
            var elem = $(this).closest('form').find(".chars");
            $(this).limiter(100, elem);
            console.log(elem);
            console.log($(this));
        });
        $('textarea').autosize();
    }
    
    $(function() {
        $.fn.extend( {
            limiter: function(limit, elem) {
                $(this).on("keyup focus", function() {
                    setCount(this, elem);
                });
                function setCount(src, elem) {
                    var chars = src.value.length;
                    if (chars > limit) {
                        src.value = src.value.substr(0, limit);
                        chars = limit;
                    }
                    elem.html( limit - chars );
                }
                setCount($(this)[0], elem);
            }
        });
        resetPosts();
        var lastScrollTop = $(window).scrollTop();
        var loaded = false;
        var post = 0;
        $( window  ).scroll(function() {
            var position = $(window).scrollTop();
            if (!loaded && post < 5 && position > lastScrollTop && position + $(window).height() == $(document).height()) {
                loaded = true;
                $.ajax( {
                    type: 'GET',
                    async: false,
                    url:'post.json',
                    success:function(data) {
                        var comments = '';
                        $.each(data.comments, function(k, v){
                            comments += '\<div class="single-comment"><div class="avatar"><img src=' + '"' + v.user.avatar + '"' +
                                    '\>\</div><div class="content"><p><a href="javascript:void(0)">' + v.user.username +
                                    '\</a> ' + v.comment.description +
                                    '\</p><small>' + v.comment.time +
                                    '\</small></div><div class="control"></div></div>';
                        });
                        var html = '\<div class="single-post"><div class="content"><div class="single-photo"><img src=' + '"' + data.post.singlephoto + '"' +
                                '\>\</div><div class="info"><h3 class="title">' + data.post.title +
                                '\</h3><small class="category">Post in <a href="javascript:void(0)">' + data.post.category +
                                '\</a></small><div class="avatar"><img src=' + '"' + data.post.user.avatar + '"' +
                                '\>\</div><div class="info-detail"><div class="description"><p><a href="javascript:void(0)">' + data.post.user.username +
                                '\</a> ' + data.post.description +
                                '\</p><small>' + data.post.time +
                                '\</small></div></div></div><a href="javascript:void(0)" class="view-comment" >Show comments</a><div class="comment">' + comments +
                                '\<div class="single-comment new-comment"><div class="avatar"><img src=' + '"' + data.user.avatar + '"' +
                                '\>\</div><form class="content"><textarea rows="1" maxlength="500"></textarea><button type="submit">Comment</button><span class="chars"></span></form></div></div></div></div>';
                        $(html).hide().appendTo($('#content-container')).fadeIn().css("display","inline-block");
                        resetPosts();
                        post ++;
                    },
                    error: function(e)
                    {
                        alert(e.message);
                    }
                });
            }else{
                console.log("dkm dkm dkm dkm dkm");
            }
            lastScrollTop = position;
            loaded = false;
        });
    });

</script>
</body>
</html>